---
layout: post
title: "Sierpinski 三角形"
date: 2015-01-10 01:44:29 +0800
comments: true
categories: problem
tags: [scala, algorithm]
---
## 题目概述
一个Sierpinski 三角形，形状如下所示：
<pre>
_______________________________1_______________________________  
______________________________111______________________________  
_____________________________1___1_____________________________  
____________________________111_111____________________________  
___________________________1_______1___________________________  
__________________________111_____111__________________________  
_________________________1___1___1___1_________________________  
________________________111_111_111_111________________________  
_______________________1_______________1_______________________  
______________________111_____________111______________________  
_____________________1___1___________1___1_____________________  
____________________111_111_________111_111____________________  
___________________1_______1_______1_______1___________________  
__________________111_____111_____111_____111__________________  
_________________1___1___1___1___1___1___1___1_________________  
________________111_111_111_111_111_111_111_111________________  
_______________1_______________________________1_______________  
______________111_____________________________111______________  
_____________1___1___________________________1___1_____________  
____________111_111_________________________111_111____________  
___________1_______1_______________________1_______1___________  
__________111_____111_____________________111_____111__________  
_________1___1___1___1___________________1___1___1___1_________  
________111_111_111_111_________________111_111_111_111________  
_______1_______________1_______________1_______________1_______  
______111_____________111_____________111_____________111______  
_____1___1___________1___1___________1___1___________1___1_____
____111_111_________111_111_________111_111_________111_111____
___1_______1_______1_______1_______1_______1_______1_______1___
__111_____111_____111_____111_____111_____111_____111_____111__
_1___1___1___1___1___1___1___1___1___1___1___1___1___1___1___1_
111_111_111_111_111_111_111_111_111_111_111_111_111_111_111_111
</pre>
<!-- more -->
这道题目来自于[hackerrank](https://www.hackerrank.com/)，题目的要求是打印这个
图形，32行，63列的n次迭代后的图形。迭代过程描述如下：

### 零次迭代的结果：
<pre>
_______________________________1_______________________________
______________________________111______________________________
_____________________________11111_____________________________
____________________________1111111____________________________
___________________________111111111___________________________
__________________________11111111111__________________________
_________________________1111111111111_________________________
________________________111111111111111________________________
_______________________11111111111111111_______________________
______________________1111111111111111111______________________
_____________________111111111111111111111_____________________
____________________11111111111111111111111____________________
___________________1111111111111111111111111___________________
__________________111111111111111111111111111__________________
_________________11111111111111111111111111111_________________
________________1111111111111111111111111111111________________
_______________111111111111111111111111111111111_______________
______________11111111111111111111111111111111111______________
_____________1111111111111111111111111111111111111_____________
____________111111111111111111111111111111111111111____________
___________11111111111111111111111111111111111111111___________
__________1111111111111111111111111111111111111111111__________
_________111111111111111111111111111111111111111111111_________
________11111111111111111111111111111111111111111111111________
_______1111111111111111111111111111111111111111111111111_______
______111111111111111111111111111111111111111111111111111______
_____11111111111111111111111111111111111111111111111111111_____
____1111111111111111111111111111111111111111111111111111111____
___111111111111111111111111111111111111111111111111111111111___
__11111111111111111111111111111111111111111111111111111111111__
_1111111111111111111111111111111111111111111111111111111111111_
111111111111111111111111111111111111111111111111111111111111111
</pre>

### 一次迭代的结果

<pre>
_______________________________1_______________________________
______________________________111______________________________
_____________________________11111_____________________________
____________________________1111111____________________________
___________________________111111111___________________________
__________________________11111111111__________________________
_________________________1111111111111_________________________
________________________111111111111111________________________
_______________________11111111111111111_______________________
______________________1111111111111111111______________________
_____________________111111111111111111111_____________________
____________________11111111111111111111111____________________
___________________1111111111111111111111111___________________
__________________111111111111111111111111111__________________
_________________11111111111111111111111111111_________________
________________1111111111111111111111111111111________________
_______________1_______________________________1_______________
______________111_____________________________111______________
_____________11111___________________________11111_____________
____________1111111_________________________1111111____________
___________111111111_______________________111111111___________
__________11111111111_____________________11111111111__________
_________1111111111111___________________1111111111111_________
________111111111111111_________________111111111111111________
_______11111111111111111_______________11111111111111111_______
______1111111111111111111_____________1111111111111111111______
_____111111111111111111111___________111111111111111111111_____
____11111111111111111111111_________11111111111111111111111____
___1111111111111111111111111_______1111111111111111111111111___
__111111111111111111111111111_____111111111111111111111111111__
_11111111111111111111111111111___11111111111111111111111111111_
1111111111111111111111111111111_1111111111111111111111111111111
</pre>

### 二次迭代的结果

<pre>
_______________________________1_______________________________
______________________________111______________________________
_____________________________11111_____________________________
____________________________1111111____________________________
___________________________111111111___________________________
__________________________11111111111__________________________
_________________________1111111111111_________________________
________________________111111111111111________________________
_______________________1_______________1_______________________
______________________111_____________111______________________
_____________________11111___________11111_____________________
____________________1111111_________1111111____________________
___________________111111111_______111111111___________________
__________________11111111111_____11111111111__________________
_________________1111111111111___1111111111111_________________
________________111111111111111_111111111111111________________
_______________1_______________________________1_______________
______________111_____________________________111______________
_____________11111___________________________11111_____________
____________1111111_________________________1111111____________
___________111111111_______________________111111111___________
__________11111111111_____________________11111111111__________
_________1111111111111___________________1111111111111_________
________111111111111111_________________111111111111111________
_______1_______________1_______________1_______________1_______
______111_____________111_____________111_____________111______
_____11111___________11111___________11111___________11111_____
____1111111_________1111111_________1111111_________1111111____
___111111111_______111111111_______111111111_______111111111___
__11111111111_____11111111111_____11111111111_____11111111111__
_1111111111111___1111111111111___1111111111111___1111111111111_
111111111111111_111111111111111_111111111111111_111111111111111
</pre>

### 本文开头给出的4次迭代的结果


使用纯粹的函数式编程方法，不定义任何的局部变量（可变和不可变的局部变量均不允许）。
这也是这道题目面临的最大挑战。

## 解法
使用scala，采用函数式编程可以简要地解决如下：

```scala
object Sierpinski {
  def drawTriangles(n: Int) {
    def construct(i: Int, n: Int, m: Int): String = {
      if (n == 0) "_" * (m-i) + "1"*(2*i-1) + "_" * (m-i)
      else {
        if (i > m/2) construct(i-m/2, n-1, m/2) + "_" + construct(i-m/2, n-1, m/2)
        else "_"*(m/2) + construct(i, n-1, m/2) + "_"*(m/2)
      }
    }
    for (i <- 1 to 32) println(construct(i, n, 32))
  }

  def main(args: Array[String]) {
    drawTriangles(readInt())
  }
}
```

采用分治法，代码非常简洁地解决了这个问题。下面描述下分治的想法：

### 1 初始情况

> 迭代次数$n$为0, 问题的规模为$m$ （$m$是$2^k$，本题目中$m=2^5$，因而$n \lt 6$）

这时候，是直接在一个m * (2*m-1)的矩形中打印这个三角形，
我的想法是按照行进行分解这样每行的内容为：

```scala
"_" * (m-i) + "1"*(2*i-1) + "_" * (m-i)
```

### 2 加入迭代

> 迭代次数由$n => n-1$， 问题规模为$m$

一个规模为m的问题，在进行一次迭代时，可以分解为三个$m/2$的问题的组合:

+ 对与三角形的上半部分$(m/2 * (2*m-1))$，

相当于将一个$m/2$规模的三角形打印在这个长方体的中央:

```scala
 "_"*(m/2) + construct(i, n-1, m/2) + "_"*(m/2)
```
+ 对于三角形的下半部分

相当于两个$m/2$规模的三角形的组合，打印代码如下：

```scala
construct(i-m/2, n-1, m/2) + "_" + construct(i-m/2, n-1, m/2)
```
注意，对行做了一个向上平移的变换。

这样就简单的解决了问题。
打印出n为5的情况，如下所示：
<pre>
_______________________________1_______________________________
______________________________1_1______________________________
_____________________________1___1_____________________________
____________________________1_1_1_1____________________________
___________________________1_______1___________________________
__________________________1_1_____1_1__________________________
_________________________1___1___1___1_________________________
________________________1_1_1_1_1_1_1_1________________________
_______________________1_______________1_______________________
______________________1_1_____________1_1______________________
_____________________1___1___________1___1_____________________
____________________1_1_1_1_________1_1_1_1____________________
___________________1_______1_______1_______1___________________
__________________1_1_____1_1_____1_1_____1_1__________________
_________________1___1___1___1___1___1___1___1_________________
________________1_1_1_1_1_1_1_1_1_1_1_1_1_1_1_1________________
_______________1_______________________________1_______________
______________1_1_____________________________1_1______________
_____________1___1___________________________1___1_____________
____________1_1_1_1_________________________1_1_1_1____________
___________1_______1_______________________1_______1___________
__________1_1_____1_1_____________________1_1_____1_1__________
_________1___1___1___1___________________1___1___1___1_________
________1_1_1_1_1_1_1_1_________________1_1_1_1_1_1_1_1________
_______1_______________1_______________1_______________1_______
______1_1_____________1_1_____________1_1_____________1_1______
_____1___1___________1___1___________1___1___________1___1_____
____1_1_1_1_________1_1_1_1_________1_1_1_1_________1_1_1_1____
___1_______1_______1_______1_______1_______1_______1_______1___
__1_1_____1_1_____1_1_____1_1_____1_1_____1_1_____1_1_____1_1__
_1___1___1___1___1___1___1___1___1___1___1___1___1___1___1___1_
1_1_1_1_1_1_1_1_1_1_1_1_1_1_1_1_1_1_1_1_1_1_1_1_1_1_1_1_1_1_1_1
</pre>
